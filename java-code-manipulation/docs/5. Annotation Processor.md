# 5. Annotation Processor<br/>## 목차<br/><br/><br/># 💡 Lombok 은 어떻게 동작할까?> 롬복은 지루하고 반복적인 코드를 자동적으로 생성해주는 툴이다.- getter, setter, toString, equals, hashCode 등등```groovydependencies {    compileOnly 'org.projectlombok:lombok'    annotationProcessor 'org.projectlombok:lombok'    //테스트에서 lombok 사용    testCompileOnly 'org.projectlombok:lombok'    testAnnotationProcessor 'org.projectlombok:lombok'}```## ⚡️ 롬복의 원리- `Java` 가 제공하는 `Annotation Processor` 를 이용한 기술   - Annotation Processor 는 compile 할 때 끼어들어서 특정한 Annotation 이 붙어있는 소스 코드를 참조해서 또 다른 소스 코드를 만들어낼 수 있는 기능이다.   - Annotation 이 붙어있는 클래스의 정보를 Tree 구조로 참조할 수 있는데, 그것을 `AST(Abstract Syntax Tree)` 라고 한다.  - 자바코드 뿐만이 아니라, 파일이나 문서 등을 만들어 낼 수 있다.- AST(Abstarct Syntax Tree) 소스코드의 정보를 트리구조로 볼 수 있다.    - 이를 신텍스 트리라고 한다.    - 본래는 참조만 가능하다.## ⚡️ 논란- 공개된 API가 아닌 컴파일러 내부 클래스를 사용하고 기존 소스코드를 조작한다.- 특히 이클립스의 경우 `javaagent`를 사용하여 컴파일러 클래스까지 조작하여 사용한다. 해당 클래스들 역시 공개된 API가 아니다 보니 버전호환성에 문제가 생길수 있다.- 롬복이 해킹이라고 주장하고 사용해선 안된다는 개발자들도 상당히 많다.- 그럼에도 불구하고 100% 대안은 없다.- 대안    - [AutoValue](https://github.com/google/auto/blob/main/value/userguide/index.md)    - [Immutables](https://immutables.github.io/)## ⚡️ 참고- https://docs.oracle.com/javase/8/docs/api/javax/annotation/processing/Processor.html- https://projectlombok.org/contributing/lombok-execution-path- https://stackoverflow.com/questions/36563807/can-i-add-a-method-to-a-class-from-a-compile-time-annotation- http://jnb.ociweb.com/jnb/jnbJan2010.html#controversy- https://www.oracle.com/technetwork/articles/grid/java-5-features-083037.html- https://wiki.mhson.world/java-spring/java/lombok\<br/><br/><br/># 💡 Annotation Processor 정리## ⚡️ 애노테이션 프로세서- 소스코드 레벨에서 소스코드에 붙어있는 애노테이션 정보를 읽어, 컴파일러가 컴파일 중에 새로운 소스를 생성하거나, 변경(권장하지않음)이 가능하다.- 소스코드와 별개의 리소스 파일도 생성이 가능한 강력한 기능## ⚡️ 사용예시- 롬복- [AutoService](https://github.com/google/auto/tree/main/service)  - java.util.ServiceLoader 용 파일 생성 유틸리티  - 리소스 파일을 만들어준다.- [@Override](https://stackoverflow.com/questions/18189980/how-do-annotations-like-override-work-internally-in-java/18202623)  - Java5에서 기본제공 되던 애노테이션 프로세서  - 오버라이드 대상이 아닌 매소드에 붙였을 때에는 컴파일 에러가 난다.  - 실제로 인터페이스나 상위클래스를 구현하는지 판단해준다.- [Dagger2](https://github.com/google/dagger)  - 컴파일 타임 DI 제공- Android Library   - [ButterKnife](http://jakewharton.github.io/butterknife/) : @BindView - 뷰 아이디와 에노테이션 붙인 필드를 바인딩해준다.   - [DeepLinkDispatch](https://github.com/airbnb/DeepLinkDispatch) : 특정 URI 링크를 Activity 로 연결할 때 사용된다.## ⚡️ Annotation Processor 특징**장점**- 런타임 비용이 제로이다.- 컴파일 할 때, 이미 뭔가 조작된 상태이다. 따라서 런타임 시에는 추가되는 비용이 없다.**단점**- 기존의 코드를 고치는 방법은 public한 API를 제공하지 않는다.- lombok 처럼 해킹을 통해 소스코드를 변경하는 방법밖에는 없다. (논란) 